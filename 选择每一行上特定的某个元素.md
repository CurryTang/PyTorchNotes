---


---

<h1 id="选择每一行上特定的某个元素">选择每一行上特定的某个元素</h1>
<p>在实际使用中经常会需要根据一个数组来选择另一个矩阵每一行上特定的某个元素（比如计算svm的loss, 计算sailency map). 在numpy中，我们可以通过array indexing来完成这个任务。其实在pytorch中，我们也可以通过一行代码完成这个任务。</p>
<pre class=" language-python"><code class="prism  language-python">In <span class="token punctuation">[</span><span class="token number">57</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token comment"># Example of using gather to select one entry from each row in PyTorch</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span> <span class="token keyword">def</span> <span class="token function">gather_example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>     N<span class="token punctuation">,</span> C <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>     s <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>N<span class="token punctuation">,</span> C<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>     y <span class="token operator">=</span> torch<span class="token punctuation">.</span>LongTensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>     <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>     <span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>     <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span> gather_example<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span> 
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.1200</span><span class="token punctuation">,</span>  <span class="token number">0.7401</span><span class="token punctuation">,</span>  <span class="token number">1.2936</span><span class="token punctuation">,</span>  <span class="token number">0.6183</span><span class="token punctuation">,</span>  <span class="token number">0.6804</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.5104</span><span class="token punctuation">,</span>  <span class="token number">0.5472</span><span class="token punctuation">,</span>  <span class="token number">0.6910</span><span class="token punctuation">,</span>  <span class="token number">1.1683</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4315</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.8384</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3702</span><span class="token punctuation">,</span>  <span class="token number">1.3011</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.7591</span><span class="token punctuation">,</span>  <span class="token number">1.0736</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2.0685</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.8530</span><span class="token punctuation">,</span>  <span class="token number">0.5570</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0464</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.5682</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">0.7401</span><span class="token punctuation">,</span>  <span class="token number">0.6910</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3702</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0464</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


</code></pre>

